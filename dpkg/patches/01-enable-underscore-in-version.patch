diff -Naur orig/lib/dpkg/parsehelp.c patched/lib/dpkg/parsehelp.c
--- orig/lib/dpkg/parsehelp.c	2012-07-19 14:27:36.000000000 +0200
+++ patched/lib/dpkg/parsehelp.c	2012-11-25 11:02:47.089332129 +0100
@@ -261,11 +261,11 @@
   if (*ptr && !cisdigit(*ptr++))
     return dpkg_put_warn(err, _("version number does not start with digit"));
   for (; *ptr; ptr++) {
-    if (!cisdigit(*ptr) && !cisalpha(*ptr) && strchr(".-+~:", *ptr) == NULL)
+    if (!cisdigit(*ptr) && !cisalpha(*ptr) && strchr(".-+~:_", *ptr) == NULL)
       return dpkg_put_warn(err, _("invalid character in version number"));
   }
   for (ptr = rversion->revision; *ptr; ptr++) {
-    if (!cisdigit(*ptr) && !cisalpha(*ptr) && strchr(".+~", *ptr) == NULL)
+    if (!cisdigit(*ptr) && !cisalpha(*ptr) && strchr(".+~_", *ptr) == NULL)
       return dpkg_put_warn(err, _("invalid character in revision number"));
   }
 
diff -Naur orig/lib/dpkg/test/t-version.c patched/lib/dpkg/test/t-version.c
--- orig/lib/dpkg/test/t-version.c	2012-07-19 14:27:36.000000000 +0200
+++ patched/lib/dpkg/test/t-version.c	2012-11-25 11:07:39.850783859 +0100
@@ -225,8 +225,8 @@
 	test_pass(dpkg_version_compare(&a, &b) == 0);
 
 	/* Test valid characters in upstream version. */
-	b = version(0, "09azAZ.-+~:", "0");
-	test_pass(parseversion(&a, "0:09azAZ.-+~:-0", NULL) == 0);
+	b = version(0, "09azAZ.-+~:_", "0");
+	test_pass(parseversion(&a, "0:09azAZ.-+~:_-0", NULL) == 0);
 	test_pass(dpkg_version_compare(&a, &b) == 0);
 
 	/* Test valid characters in revision. */
@@ -258,7 +258,7 @@
 
 	/* Test invalid characters in upstream version. */
 	verstr = m_strdup("0:0a-0");
-	for (p = "!#@$%&/|\\<>()[]{};,_=*^'"; *p; p++) {
+	for (p = "!#@$%&/|\\<>()[]{};,=*^'"; *p; p++) {
 		verstr[3] = *p;
 		test_fail(parseversion(&a, verstr, &err) == 0);
 		test_warn(err);
